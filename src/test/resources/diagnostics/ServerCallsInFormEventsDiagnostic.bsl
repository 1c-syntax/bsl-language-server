// Тест для диагностики ServerCallsInFormEventsDiagnostic
// Проверяет, что в событиях ПриАктивизацииСтроки и НачалоВыбора нет вызовов серверных процедур

// Правильные события (без вызовов серверных процедур)
Процедура ПриАктивизацииСтроки(Элемент, ВыбраннаяСтрока, Поле, НовоеЗначение, СтандартнаяОбработка)
    // Обработка на клиенте - правильно
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

Процедура НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    // Обработка на клиенте - правильно
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

// Неправильные события (с вызовами серверных процедур)
&НаКлиенте
Процедура ПриАктивизацииСтроки(Элемент, ВыбраннаяСтрока, Поле, НовоеЗначение, СтандартнаяОбработка)
    // Ошибка: вызов серверной процедуры из клиентского события
    ТаблицаФормыПриАктивизацииСтрокиНаСервере();
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

&НаКлиенте
Процедура НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    // Ошибка: вызов серверной процедуры из клиентского события
    НачалоВыбораНаСервере();
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

// Английские названия событий
&AtClient
Процедура OnActivateRow(Элемент, ВыбраннаяСтрока, Поле, НовоеЗначение, СтандартнаяОбработка)
    // Правильно: без вызовов серверных процедур
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

&AtClient
Процедура OnStartChoice(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    // Ошибка: вызов серверной процедуры из клиентского события (глобальный вызов)
    OnStartChoiceAtServer();
    // Ошибка: вызов серверной процедуры из клиентского события (локальный вызов)
    ЛокальнаяСервернаяПроцедура();
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

&НаКлиенте
Процедура ПриАктивизацииСтроки(Элемент, ВыбраннаяСтрока, Поле, НовоеЗначение, СтандартнаяОбработка)
    // Ошибка: локальный вызов серверной процедуры из клиентского события
    ЛокальнаяСервернаяПроцедура();
    // Ошибка: еще один локальный вызов
    ЛокальнаяСервернаяПроцедураБезКонтекста();
    // Ошибка: вызов через переменную (должен обрабатываться через visitMethodCall)
    ИмяПроцедуры = "ЛокальнаяСервернаяПроцедура";
    Выполнить(ИмяПроцедуры);
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

// Серверные процедуры (могут вызываться из обычных процедур)
&НаСервере
Процедура ТаблицаФормыПриАктивизацииСтрокиНаСервере()
    // Серверная процедура - это нормально
    ВызватьИсключение "тест";
КонецПроцедуры

&НаСервере
Процедура НачалоВыбораНаСервере()
    // Серверная процедура - это нормально
КонецПроцедуры

&AtServer
Процедура OnStartChoiceAtServer()
    // Серверная процедура - это нормально
КонецПроцедуры

&НаСервере
Процедура ЛокальнаяСервернаяПроцедура()
    // Локальная серверная процедура - это нормально
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ЛокальнаяСервернаяПроцедураБезКонтекста()
    // Локальная серверная процедура без контекста - это нормально
КонецПроцедуры

// Обычные процедуры (не должны срабатывать диагностика)
Процедура ОбычнаяПроцедура()
    // Обычная процедура - можно вызывать серверные процедуры
    ТаблицаФормыПриАктивизацииСтрокиНаСервере();
КонецПроцедуры

// Дополнительный тест для покрытия несуществующих методов
&НаКлиенте
Процедура ПриАктивизацииСтроки(Элемент, ВыбраннаяСтрока, Поле, НовоеЗначение, СтандартнаяОбработка)
    // Ошибка: вызов несуществующего серверного метода (для покрытия methodSymbolOpt.isEmpty())
    НеСуществующийСерверныйМетод();
    СтандартнаяОбработка = Ложь;
КонецПроцедуры

// Процедура без директив (для покрытия compilerDirective.isEmpty())
Процедура ПроцедураБезДиректив()
    // Обычная процедура без директив
КонецПроцедуры

&НаКлиенте
Процедура НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    // Ошибка: вызов процедуры без директив (для покрытия compilerDirective.isEmpty())
    ПроцедураБезДиректив();
    СтандартнаяОбработка = Ложь;
КонецПроцедуры
